export const metadata = {
  title: 'next/mdxë¡œ ë¸”ë¡œê·¸ ë§Œë“¤ê¸°',
  tags: ['#next.js', 'next/mdx'],
  date: '2025-02-17 00:51:31',
}

ì´ì „ì— Svelte Kit + md ì¡°í•©ì´ì—ˆë˜ ë¸”ë¡œê·¸ë¥¼ Next.js + mdx ì¡°í•©ìœ¼ë¡œ ë‹¤ì‹œ ë§Œë“¤ì—ˆë‹¤. ë¸”ë¡œê·¸ì˜ ì²« ë²„ì „ì´ Next.js 13ë²„ì „ìœ¼ë¡œ ë§Œë“¤ì—ˆëŠ”ë°, ê·¸ ì‚¬ì´ì— ê¸€ì´ ëŠ˜ì–´ë‚œ ê²ƒì€ ë³„ë¡œ ì—†ê³  í™˜ê²½ë§Œ 2ë²ˆ ë°”ë€ ì…ˆì´ë‹¤.
ì¡°í•©ì„ ë³€ê²½í•œ ì´ìœ ë¡œëŠ” ì•„ë˜ì™€ ê°™ë‹¤.

1. ìŠ¤ë²¨íŠ¸ í™˜ê²½ì´ TSê°€ ì•„ë‹Œ JS í™˜ê²½ì´ë¼, TSë¡œ ë‹¤ ë³€ê²½ì´ í•„ìš”í–ˆë˜ ì 
2. ë¸”ë¡œê·¸ ë§ê³ ëŠ” ìŠ¤ë²¨íŠ¸ë¥¼ ì‚¬ìš©í•  ì¼ì´ ì—†ëŠ” ì 

ì–´ì°¨í”¼ ë³€ê²½ì´ í•„ìš”í•˜ë‹¤ë©´ ì•„ì˜ˆ ìƒˆë¡œ êµ¬ì¶•í•˜ëŠ” ê²Œ ë‚˜ì„ë“¯ í•˜ì—¬ Next.jsë¡œ ìƒˆë¡œ ë§Œë“¤ì–´ë²„ë ¸ë‹¤.
ìŠ¤ë²¨íŠ¸ë¡œëŠ” ë§ˆí¬ë‹¤ìš´ í™˜ê²½ì„ êµ¬ì¶•í•˜ê¸° ìœ„í•´ì„œëŠ” `mdsvex` npmì„ ì‚¬ìš©í•´ì•¼ í–ˆëŠ”ë°, Next.jsì—ì„œëŠ” ì•„ì˜ˆ next íŒ¨í‚¤ì§€ì¤‘ í•˜ë‚˜ì¸ [next/mdx íŒ¨í‚¤ì§€](https://github.com/vercel/next.js/tree/canary/packages/next-mdx)ë¥¼ ì‚¬ìš©í•´ êµ¬ì¶•ì´ ê°€ëŠ¥í•œ ì ë„ ë©”ë¦¬íŠ¸ë¡œ ì‘ìš©í–ˆë‹¤.

ì£¼ì ˆì£¼ì ˆì´ ê¸¸ì—ˆì§€ë§Œ, ê²°ë¡ ì€.. ë‹¤ì‹œ ë„¥ìŠ¤íŠ¸ ì“°ê³  ì‹¶ì—ˆë‹¤ëŠ” ê²°ë¡ ì´ë‹¤. íšŒì‚¬ í™˜ê²½ì€ ì–´ì°¨í”¼ v12ì´ë¼ ì•±ë¼ìš°í„°ëŠ” ê¿ˆë„ ëª»ê¾¸ì§€ë§Œ ì¼ë‹¨ì€ ì¨ë´ì•¼ ì–´ë–»ê²Œ ë³€ê²½í• ì§€ ìƒê°ì´ë¼ë„ í•´ë³¼ ìˆ˜ ìˆë‹¤ëŠ” íŒë‹¨ì´ì—ˆë‹¤.

---

## next/mdxë¥¼ ì‚¬ìš©í•˜ì—¬ ë¸”ë¡œê·¸ ë§Œë“¤ê¸°

https://nextjs.org/docs/pages/building-your-application/configuring/mdx ì—ì„œ ìì„¸í•˜ê²Œ ì„¤ëª…í•˜ê³  ìˆì§€ë§Œ, ë‹¤ì‹œ ì •ë¦¬í•  ê²¸ ì‘ì„±í•´ë³¸ë‹¤.

### ì˜ì¡´ì„± ì„¤ì¹˜ ë° next config ì„¤ì •

- ë¨¼ì € `npm install @next/mdx @mdx-js/loader @mdx-js/react @types/mdx` ë¥¼ ì„¤ì¹˜í•œë‹¤.
- next.config.mjs ì—…ë°ì´íŠ¸ (ì•„ë˜ì™€ ê°™ì´ ì„¤ì •í–ˆë‹¤.)

```ts
import createMDX from '@next/mdx'
import type { NextConfig } from 'next'
import rehypeHighlight from 'rehype-highlight'
import remarkGfm from 'remark-gfm'

/** @type {import('next').NextConfig} */
const nextConfig: NextConfig = {
  // ë§ˆí¬ë‹¤ìš´ ë° MDX íŒŒì¼ì„ í¬í•¨í•˜ë„ë¡ `pageExtensions`ë¥¼ êµ¬ì„±í•©ë‹ˆë‹¤
  pageExtensions: ['js', 'jsx', 'md', 'mdx', 'ts', 'tsx'],
  experimental: {
    mdxRs: false,
  },
  transpilePackages: ['three'],
}

const withMDX = createMDX({
  options: {
    remarkPlugins: [remarkGfm],
    // rehypePlugins: [[rehypeHighlight, { ignoreMissing: true }, rehypeCodeTitles]],
    rehypePlugins: [[rehypeHighlight, { ignoreMissing: true }]],
  },
})

export default withMDX(nextConfig)
```

- `remarkGfm` íŒ¨í‚¤ì§€ëŠ” ë§ˆí¬ë‹¤ìš´ì—ì„œ table ë“± ë§ˆí¬ë‹¤ìš´ ë¬¸ë²•ì„ í•´ì„í•  ìˆ˜ ìˆë„ë¡ í•´ì£¼ë¯€ë¡œ í•„ìˆ˜ì ìœ¼ë¡œ ì¶”ê°€í•´ì¤€ë‹¤.
- `rehypeHighlight`ëŠ” ì½”ë“œ ì—ë””í„° ìŠ¤íƒ€ì¼ë§ì„ ìœ„í•´ ì¶”ê°€í–ˆë‹¤.

---

### mdx-components.tsx ì¶”ê°€í•˜ê¸°

- í•´ë‹¹ íŒŒì¼ì€ `root` ì— ì¶”ê°€í•´ì•¼í•œë‹¤.
- `pages` ë˜ëŠ” `app` í´ë”ì™€ ê°™ì€ ë ˆë²¨ì— ì¶”ê°€í—¤ì•¼í•œë‹¤.
- ì•± ë¼ìš°íŠ¸ì™€ í•¨ê»˜ ì‚¬ìš©í•˜ì§€ ì•Šìœ¼ë©´ ì‘ë™í•˜ì§€ ì•ŠëŠ”ë‹¤.
- í•´ë‹¹ íŒŒì¼ì—ì„œ ìŠ¤íƒ€ì¼ë§ì„ ì§€ì •í•  ìˆ˜ ìˆë‹¤.
- ì•„ë˜ì™€ ê°™ì´ ì„¤ì •í–ˆë‹¤. Cursor AIì˜ ë„ì›€ìœ¼ë¡œ ë¹ ë¥´ê²Œ ìŠ¤íƒ€ì¼ë§ í•  ìˆ˜ ìˆì—ˆë‹¤. codeì˜ ìŠ¤íƒ€ì¼ë§ë„ ì§€ì •ë˜ì–´ìˆê¸´ í•˜ì§€ë§Œ, inline codeë§Œ ì•„ë˜ ìŠ¤íƒ€ì¼ë§ì´ ì§€ì •ë˜ê³ , inlineì´ ì•„ë‹Œ ê²½ìš°ì—ëŠ” rehypeHighlightë¡œ ìŠ¤íƒ€ì¼ë§ ëœë‹¤.
- [@tailwindcss/typography](https://tailwindcss.com/docs/adding-custom-styles#functional-utilities) ë¥¼ ì‚¬ìš©í•˜ë©´ ë”°ë¡œ ìŠ¤íƒ€ì¼ë§í•  í•„ìš” ì—†ì´ ì˜ˆì˜ê²Œ ì˜ ë‚˜ì˜¤ì§€ë§Œ, ì»¤ìŠ¤í…€ì´ ì¡°ê¸ˆ ë¶ˆí¸í•´ì„œ ì²˜ìŒë¶€í„° ì»¤ìŠ¤í…€í•˜ê¸°ë¡œ í–ˆë‹¤.

```tsx
import Link from 'next/link'
import { ComponentPropsWithoutRef } from 'react'

// ê³µí†µ ìŠ¤íƒ€ì¼ ë³€ìˆ˜
const styles = {
  text: {
    base: 'text-base text-gray-800 dark:text-zinc-300 font-[500]',
    heading: 'text-gray-800 dark:text-zinc-200 font-[600]',
  },
  spacing: {
    heading: 'mt-6 mb-2',
  },
  link: {
    base: 'text-blue-500 hover:text-blue-700 dark:text-gray-400 hover:dark:text-gray-300',
    decoration: 'dark:underline dark:underline-offset-2 dark:decoration-gray-800',
  },
  list: {
    base: 'text-base text-gray-800 dark:text-zinc-300 pl-5 space-y-1',
  },
  code: {
    inline:
      'px-1.5 py-0.5 rounded-md bg-gray-100 dark:bg-[#0d1117] font-mono text-sm border border-gray-200 dark:border-gray-700 mx-1',
    block:
      'p-4 rounded-lg bg-gray-100 dark:bg-zinc-800 overflow-x-auto text-xs border border-gray-200 dark:border-gray-700',
  },
}

type HeadingProps = ComponentPropsWithoutRef<'h1'>
type ParagraphProps = ComponentPropsWithoutRef<'p'>
type ListProps = ComponentPropsWithoutRef<'ul'>
type ListItemProps = ComponentPropsWithoutRef<'li'>
type AnchorProps = ComponentPropsWithoutRef<'a'>
type BlockquoteProps = ComponentPropsWithoutRef<'blockquote'>

const components = {
  h1: (props: HeadingProps) => <h1 className="font-medium text-2xl pt-10 mb-3" {...props} />,
  h2: (props: HeadingProps) => (
    <h2
      className={`${styles.text.heading} font-medium text-xl ${styles.spacing.heading}`}
      {...props}
    />
  ),
  h3: (props: HeadingProps) => (
    <h3
      className={`${styles.text.heading} font-medium text-lg ${styles.spacing.heading}`}
      {...props}
    />
  ),
  h4: (props: HeadingProps) => (
    <h4
      className={`${styles.text.heading} font-medium text-base ${styles.spacing.heading}`}
      {...props}
    />
  ),
  p: (props: ParagraphProps) => (
    <p className={`${styles.text.base} leading-relaxed my-4`} {...props} />
  ),
  ol: (props: ListProps) => <ol className={`${styles.list.base} list-decimal`} {...props} />,
  ul: (props: ListProps) => <ul className={`${styles.list.base} list-disc`} {...props} />,
  li: (props: ListItemProps) => <li className="pl-1" {...props} />,
  em: (props: ComponentPropsWithoutRef<'em'>) => <em className="font-medium italic" {...props} />,
  strong: (props: ComponentPropsWithoutRef<'strong'>) => (
    <strong className="font-semibold" {...props} />
  ),
  a: ({ href, children, ...props }: AnchorProps) => {
    const className = `${styles.link.base} ${styles.link.decoration}`

    if (href?.startsWith('/')) {
      return (
        <Link href={href} className={className} {...props}>
          {children}
        </Link>
      )
    }
    if (href?.startsWith('#')) {
      return (
        <a href={href} className={className} {...props}>
          {children}
        </a>
      )
    }
    return (
      <a href={href} target="_blank" rel="noopener noreferrer" className={className} {...props}>
        {children}
      </a>
    )
  },
  blockquote: (props: BlockquoteProps) => (
    <blockquote
      className="ml-[0.075em] border-l-4 border-gray-300 pl-6 italic text-gray-700 dark:border-zinc-600 dark:text-zinc-300"
      {...props}
    />
  ),
  Table: ({ data }: { data: { headers: string[]; rows: string[][] } }) => (
    <table className="w-full my-6 border-collapse">
      <thead>
        <tr className="border-b dark:border-zinc-700">
          {data.headers.map((header, index) => (
            <th key={index} className="py-2 px-4 text-left font-medium">
              {header}
            </th>
          ))}
        </tr>
      </thead>
      <tbody>
        {data.rows.map((row, index) => (
          <tr key={index} className="border-b dark:border-zinc-800">
            {row.map((cell, cellIndex) => (
              <td key={cellIndex} className="py-2 px-4">
                {cell}
              </td>
            ))}
          </tr>
        ))}
      </tbody>
    </table>
  ),
  code: ({ children, ...props }: ComponentPropsWithoutRef<'code'>) => {
    // pre íƒœê·¸ ë‚´ë¶€ì˜ codeì¸ì§€ í™•ì¸ (ì½”ë“œ ë¸”ë¡)
    const isBlock = typeof children === 'object'

    return (
      <code className={isBlock ? styles.code.block : styles.code.inline} {...props}>
        {children}
      </code>
    )
  },
  pre: ({ children, ...props }: ComponentPropsWithoutRef<'pre'>) => {
    return (
      <div className="my-4">
        {/* {title && <div className="text-xs text-gray-500 dark:text-gray-400 mb-1">{title}</div>} */}
        <pre
          className="p-4 rounded-lg border-gray-800 border-1 max-w-full overflow-x-auto"
          {...props}
        >
          {children}
        </pre>
      </div>
    )
  },
  hr: (props: ComponentPropsWithoutRef<'hr'>) => <hr className="my-10" {...props} />,
}

type MDXProvidedComponents = typeof components

export function useMDXComponents(): MDXProvidedComponents {
  return components
}
```

---

### mdxì˜ ë©”íƒ€ë°ì´í„° ì„¤ì •í•˜ê¸°

ê¸°ì¡´ mdíŒŒì¼ì—ì„œ ë©”íƒ€ë°ì´í„°ë¥¼ ì„¤ì •í•  ë•ŒëŠ” ë³´í†µ ìƒë‹¨ì— ì•„ë˜ì™€ ê°™ì´ ì„¤ì •í•œë‹¤.

```md
---
title: Java Scriptì˜ íƒ€ì…ê³¼ ë¬¸ë²• (ì •ë¦¬)
tag: YOU DON'T KNOW JS, ì±…, JS
date: 2022-12-23 19:40:54
---
```

next/mdxë¥¼ ì‚¬ìš©í•˜ë©´ì„œ, ì•„ë˜ì™€ ê°™ì´ ì„¤ì •í•  ìˆ˜ ìˆê²Œë˜ì—ˆë‹¤.

```md
export const metadata = {
title: 'Java Scriptì˜ íƒ€ì…ê³¼ ë¬¸ë²• (ì •ë¦¬)',
tags: ["#YOU DON'T KNOW JS", '#ì±…', '#JS'],
date: '2022-12-23 19:40:54',
}
```

```tsx
import BlogPost, { metadata } from '@/content/blog-post.mdx'

export default function Page() {
  console.log('metadata: ', metadata)
  //=> { author: 'John Doe' }
  return <BlogPost />
}
```

- Next í™ˆí˜ì´ì§€ì˜ ì˜ˆì‹œì´ë©° ìœ„ import ë°©ì‹ì²˜ëŸ¼ metadataë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ìˆë‹¤.

í•˜ì§€ë§Œ ë³´í†µ mdx íŒŒì¼ì„ ê°€ì ¸ì˜¬ ë•ŒëŠ” í•˜ë‚˜ì”© ê°€ì ¸ì˜¤ì§€ ì•Šê³  fs ëª¨ë“ˆì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš°ê°€ ë§ìœ¼ë¯€ë¡œ ë‚˜ë„ ì•„ë˜ì™€ ê°™ì´ lib ëª¨ë“ˆì„ ë§Œë“¤ì–´ì„œ ê°€ì ¸ì˜¤ëŠ” ë°©ì‹ìœ¼ë¡œ ì‚¬ìš©í–ˆë‹¤.

```ts
const DOCS_PATH = path.join(process.cwd(), 'src/docs')

export async function getTilPosts(): Promise<Post[]> {
  const tilPath = path.join(DOCS_PATH, 'til')
  const categories = fs.readdirSync(tilPath)

  const posts = await Promise.all(
    categories.flatMap(async (category) => {
      const categoryPath = path.join(tilPath, category)
      if (!fs.statSync(categoryPath).isDirectory()) return []

      const files = fs.readdirSync(categoryPath).filter((file) => file.endsWith('.mdx'))

      const categoryPosts = await Promise.all(
        files.map(async (file) => {
          const { metadata } = await import(`@/docs/til/${category}/${file}`)
          return {
            slug: file.replace('.mdx', ''),
            category,
            metadata,
            path: `til/${category}/${file.replace('.mdx', '')}`,
          }
        })
      )

      return categoryPosts
    })
  )

  return posts
    .flat()
    .sort((a, b) => new Date(b?.metadata?.date).getTime() - new Date(a.metadata.date).getTime())
}
```

- `src/docs/til` ê²½ë¡œì˜ íŒŒì¼ì„ ê°€ì ¸ì˜¤ë„ë¡ í–ˆê³  `til` í´ë” ë‹¤ìŒì˜ í´ë”ëª…ì´ ì¹´í…Œê³ ë¦¬ëª…ì´ë¯€ë¡œ (ex `src/docs/til/category/example.mdx`) í•´ë‹¹ í´ë”ëª…ì„ path ëª…ìœ¼ë¡œ ì§€ì •í–ˆê³ , ì•„ë˜ ì½”ë“œ ì˜ˆì‹œì²˜ëŸ¼ Linkì˜ hrefë¡œ ì‚¬ìš©í–ˆë‹¤.

`app/page.tsx`

```tsx
import { getAllPostsByYear } from '@/lib/mdx'
import Link from 'next/link'

export default async function Home() {
  const postsByYear = await getAllPostsByYear()
  const years = Object.keys(postsByYear).sort((a, b) => b.localeCompare(a))

  return (
    <div>
      {years.map((year) => (
        <section key={year} className="not-prose text-base">
          <h2 className="px-5 py-10 font-bold">{year}</h2>
          {postsByYear[year]
            .sort(
              (a, b) => new Date(b.metadata.date).getTime() - new Date(a.metadata.date).getTime()
            )
            .map((post) => (
              <Link
                href={`/${post.path}`}
                className="flex items-baseline gap-4 group hover:bg-blue-50 cursor-pointer rounded-lg hover:dark:bg-blue-950 hover:dark:text-inherit hover:text-blue-700 transition-colors duration-100 dark:text-slate-300"
                key={post.path}
              >
                <article className="text-base p-5">
                  <time className="text-sm text-gray-500 w-20">
                    {new Date(post.metadata.date).toLocaleDateString('en-US', {
                      month: 'short',
                      day: 'numeric',
                    })}
                  </time>
                  <p className="font-medium my-0 ">{post.metadata.title}</p>
                </article>
              </Link>
            ))}
        </section>
      ))}
    </div>
  )
}
```

- ë…„ë„ë³„ë¡œ í¬ìŠ¤íŠ¸ë¥¼ ë¶„ë¥˜í•˜ì—¬ ë³´ì—¬ì£¼ê¸° ìœ„í•´ `getAllPostsByYear` í•¨ìˆ˜ë¥¼ ë§Œë“¤ì–´ ì‚¬ìš©í–ˆë‹¤.

---

![Image](https://github.com/user-attachments/assets/29487e7b-2714-4b6e-8f59-f297f434ed00)
ì–´ì°Œì €ì°Œ ìœ„ì™€ ê°™ì€ í™ˆí˜ì´ì§€ê°€ ë˜ì—ˆê³ , ë¸”ë¡œê·¸ v1ê³¼ ê±°ì˜ ë™ì¼í•œ í˜•íƒœê°€ ëœ ê²ƒ ê°™ê¸°ë„ í•˜ë‹¤.ğŸ˜‚

ë‹¤ìŒ ëª©í‘œëŠ” React Three Fiberë¥¼ ì‚¬ìš©í•´ ë¸”ë¡œê·¸ ì¸íŠ¸ë¡œë¥¼ ì¶”ê°€í•´ë³´ëŠ” ê±´ë°, êµ¬ìƒê³¼ ê³µë¶€ê°€ í•„ìš”í•˜ë‹ˆ ì¡°ê¸ˆ ë” ì¤€ë¹„í•´ë³´ì•„ì•¼ê² ë‹¤.

---

> ì°¸ê³  ìë£Œ

- https://nextjs.org/docs/pages/building-your-application/configuring/mdx
- https://github.com/leerob/site
