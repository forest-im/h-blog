export const metadata = {
  title: 'êµ¬ê¸€ Apps Scriptë¡œ ë‰´ìŠ¤ë ˆí„° ë§Œë“¤ê¸°',
  tags: ['#Apps Script', '#ì•±ìŠ¤ìŠ¤í¬ë¦½íŠ¸'],
  date: '2025-04-05 01:55:29',
}

![mail](https://imagedelivery.net/5LG7d9X3kuXKRQ06TLYDSg/3545928c-c574-47f8-4133-eef2da2be200/public)  
ì•±ìŠ¤ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì²˜ìŒ ì¨ë´¤ëŠ”ë°, ì—„ì²­ ê°„ë‹¨í•˜ê³  ì¢‹ë„¤..  
ê°œë°œ ê´€ë ¨ ì •ë³´ë“¤ì„ ë©”ì¼ë¡œ í•œ ë²ˆì— ë³´ê³  ì‹¶ì–´ì„œ ì•„ì¹¨ 7ì‹œ - 8ì‹œ ì‚¬ì´ì— ë©”ì¼ë¡œ ë°›ì„ ìˆ˜ ìˆëŠ” ìŠ¤í¬ë¦½íŠ¸ë¥¼ ë§Œë“¤ì—ˆë‹¤.(ë¬¼ë¡  GPTê°€ ë‹¤ ë§Œë“¤ì–´ì¤Œ.) í•˜ì§€ë§Œ ë¯¸ë””ì—„ì„ ì‚¬ìš©í•˜ëŠ” ê°œë°œ ë¸”ë¡œê·¸ëŠ” 429 ì—ëŸ¬(too many requests)ë¡œ ì¸í•´ ë˜ì§€ ì•Šì•˜ê³  ìš°ì•„í•œ í˜•ì œë“¤ì€ 403 ì—ëŸ¬ë¡œ ì¸í•´ ì‹¤íŒ¨í–ˆìŒ. ìš°ì•„í•œ í˜•ì œë“¤ì€ ë§‰í˜€ìˆëŠ” ê²ƒ ê°™ì€ë°, ì´í›„ì— ë‹¤ì‹œ ì‚´í´ë´ì•¼ê² ë‹¤.

## í¬í•¨ëœ ê¸°ëŠ¥

- ì‹œê°„ ê¸°ì¤€ í•„í„°ë§: ê¸±ë‰´ìŠ¤ë¥¼ ì œì™¸í•˜ê³ , ì–´ì œ ì•„ì¹¨ 8ì‹œ ~ ì˜¤ëŠ˜ ì•„ì¹¨ 8ì‹œê¹Œì§€ ì˜¬ë¼ì˜¨ ê¸€ë§Œ ë©”ì¼ë¡œ ìˆ˜ì§‘
- ë‹¤êµ­ì–´ ë²ˆì—­: Reddit ê°™ì€ í•´ì™¸ í”¼ë“œ ì œëª©ì€ í•œêµ­ì–´ë¡œ ë²ˆì—­
- ë§¤ì¼ ì•„ì¹¨ ìë™ ë°œì†¡: Google Apps Script íŠ¸ë¦¬ê±°ë¡œ ë§¤ì¼ 8ì‹œì— ë©”ì¼ ë°œì†¡

```js
function sendTechBlogNewsletter() {
  // âœ… RSS í”¼ë“œ URLê³¼ ì´ë¦„ ì •ì˜
  const feedUrls = [
    { name: 'ë„¤ì´ë²„ D2', url: 'https://d2.naver.com/d2.atom' },
    { name: 'ë§ˆì¼“ì»¬ë¦¬', url: 'https://helloworld.kurly.com/feed.xml' },
    { name: 'ì¹´ì¹´ì˜¤ì—”í„°í”„ë¼ì´ì¦ˆ', url: 'https://tech.kakaoenterprise.com/feed' },
    { name: 'ë¼ì¸', url: 'https://engineering.linecorp.com/ko/feed/index.html' },
    { name: 'í† ìŠ¤', url: 'https://toss.tech/rss.xml' },
    { name: 'ë±…í¬ìƒëŸ¬ë“œ', url: 'https://blog.banksalad.com/rss.xml' },
    { name: 'Hyperconnect', url: 'https://hyperconnect.github.io/feed.xml' },
    { name: 'ì˜ì¹´', url: 'https://tech.socarcorp.kr/feed' },
    { name: 'NHN Cloud', url: 'https://meetup.nhncloud.com/rss' },
    { name: 'ê¸±ë‰´ìŠ¤', url: 'https://feeds.feedburner.com/geeknews-feed', isGeekNews: true },
    { name: 'Reddit - webdev', url: 'https://www.reddit.com/r/webdev/.rss', translate: true },
    { name: 'Reddit - frontend', url: 'https://www.reddit.com/r/frontend/.rss', translate: true },
    { name: 'dev', url: 'https://dev.to/feed' },
    { name: 'Hacker News', url: 'https://hnrss.org/newest' },
  ]

  // âœ… ì‹œê°„ ì„¤ì •
  const now = new Date() // í˜„ì¬ ì‹œê°
  const timezone = 'Asia/Seoul' // í•œêµ­ ì‹œê°„

  const today8am = new Date(Utilities.formatDate(now, timezone, 'yyyy-MM-dd') + 'T08:00:00+09:00')
  const yesterday8am = new Date(today8am.getTime() - 24 * 60 * 60 * 1000)

  let emailBody = `
    <div style="font-family: Arial, sans-serif; max-width: 600px; margin: auto; color: #333;">
      <h2 style="background-color: #4CAF50; color: white; padding: 10px; text-align: center; border-radius: 4px;">
        ğŸ“° ì˜¤ëŠ˜ì˜ ê¸°ìˆ  ë¸”ë¡œê·¸ - ${Utilities.formatDate(now, timezone, 'yyyy.MM.dd')}
      </h2>
      <p style="font-size: 14px; color: #555; text-align: center;">
        ì˜¤ëŠ˜ ì•„ì¹¨ 8ì‹œ ê¸°ì¤€ìœ¼ë¡œ ëª¨ì€ ë”°ëˆë”°ëˆí•œ ê¸°ìˆ  ì†Œì‹ì´ì—ìš”!
      </p>
      <hr style="border: none; border-top: 1px solid #eee;" />
  `

  feedUrls.forEach((feed) => {
    try {
      const response = UrlFetchApp.fetch(feed.url)
      const xml = response.getContentText()
      const xmlClean = xml.replace(/[\x00-\x1F\x7F]/g, '')
      const document = XmlService.parse(xmlClean)
      const root = document.getRootElement()

      let entries = []
      const atomNamespace = XmlService.getNamespace('http://www.w3.org/2005/Atom')
      const isAtomFeed = root.getName() === 'feed'

      if (isAtomFeed) {
        const entryElements = root.getChildren('entry', atomNamespace)
        if (entryElements && entryElements.length > 0) {
          entries = entryElements
        }
      } else if (root.getChild('channel')) {
        const channelElement = root.getChild('channel')
        const items = channelElement.getChildren('item')
        if (items && items.length > 0) {
          entries = items
        }
      }

      if (entries.length === 0) {
        Logger.log(`í”¼ë“œ í•­ëª© ì—†ìŒ: ${feed.name}`)
        return
      }

      const items = entries
        .map((entry) => {
          let title, link, pubDateText

          if (isAtomFeed) {
            title = entry.getChildText('title', atomNamespace)
            const linkElement = entry.getChild('link', atomNamespace)
            link = linkElement ? linkElement.getAttribute('href').getValue() : null
            pubDateText = entry.getChildText('updated', atomNamespace)
          } else {
            title = entry.getChildText('title')
            link = entry.getChildText('link')
            pubDateText = entry.getChildText('pubDate')
          }

          const pubDate = pubDateText ? new Date(pubDateText) : null

          return { title, link, pubDate }
        })
        .filter((item) => {
          if (feed.isGeekNews) {
            return true
          }

          if (!item.pubDate) return false

          const pubTime = new Date(item.pubDate).getTime()

          // ê¸±ë‰´ìŠ¤ë¥¼ ì œì™¸í•˜ê³  ì–´ì œ ì˜¤ì „ 8ì‹œ ë¶€í„° ì˜¤ëŠ˜ ì˜¤ì „ 8ì‹œê¹Œì§€ ë°œí–‰ëœ ê¸€ë§Œ í•„í„°ë§
          return pubTime > yesterday8am.getTime() && pubTime <= today8am.getTime()
        })

      if (items.length > 0) {
        emailBody += `<h3 style="color: #4CAF50; border-bottom: 1px solid #eee; padding-bottom: 5px;">${feed.name}</h3><ul style="padding-left: 20px; margin-bottom: 20px;">`

        items.forEach((item) => {
          let translatedTitle = ''

          if (feed.translate) {
            try {
              translatedTitle = LanguageApp.translate(item.title, 'en', 'ko')
            } catch (error) {
              Logger.log(`ë²ˆì—­ ì˜¤ë¥˜: ${error}`)
            }
          }

          if (translatedTitle) {
            emailBody += `
            <li style="margin-bottom: 8px;">
              <a href="${item.link}" style="color: #1a73e8; text-decoration: none;" target="_blank">
                ${translatedTitle} (${item.title})
              </a>
            </li>
          `
          } else {
            emailBody += `
            <li style="margin-bottom: 8px;">
              <a href="${item.link}" style="color: #1a73e8; text-decoration: none;" target="_blank">
                ${item.title}
              </a>
            </li>
          `
          }
        })

        emailBody += '</ul>'
      }
    } catch (e) {
      Logger.log(`í”¼ë“œ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ (${feed.name}): ${e}`)
    }
  })

  emailBody += `
    <hr style="border: none; border-top: 1px solid #eee;" />
    <p style="font-size: 12px; color: #999; text-align: center;">
      ë³¸ ë©”ì¼ì€ ìë™ìœ¼ë¡œ ë°œì†¡ë˜ì—ˆìŠµë‹ˆë‹¤ âœ‰ï¸ <br/>
      ì¢‹ì€ í•˜ë£¨ ë˜ì„¸ìš”!
    </p>
  </div>
  `

  if (emailBody.includes('<li')) {
    const today = Utilities.formatDate(now, timezone, 'yy.MM.dd')
    const subject = `ì˜¤ëŠ˜ ${today}ì˜ ê¸°ìˆ ë¸”ë¡œê·¸ì•¼ ê¼­ ì½ì–´ë³´ë ´ğŸ©µ`
    const recipient = Session.getActiveUser().getEmail()

    MailApp.sendEmail({
      to: recipient,
      subject: subject,
      htmlBody: emailBody,
    })
  }
}
```

## íŠ¸ë¦¬ê±° ì„¤ì •

![íŠ¸ë¦¬ê±°](https://imagedelivery.net/5LG7d9X3kuXKRQ06TLYDSg/e9fdb8e7-e1ec-4794-4a09-2d7c39a51700/public)

## ë°±ë¡œê·¸

- ë©”ì¼ì— ê¸€ ìš”ì•½ ì¶”ê°€
- ë¯¸ë””ì—„ í”¼ë“œ ì¶”ê°€
